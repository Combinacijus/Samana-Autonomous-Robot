# base_local_planner: "base_local_planner/TrajectoryPlannerROS"
base_local_planner: "pose_follower/PoseFollower"

controller_frequency: 15
recovery_behavior_enabled: true
# clearing_rotation_allowed: false

PoseFollower:
    collision_planner:
      # set this to true if you're using a holonomic robot
      holonomic_robot: false
      acc_lim_x: 0.7
      acc_lim_y: 0.0
      acc_lim_theta: 1.0
      max_vel_x: 0.55
      min_vel_x: 0.04
      max_vel_theta: 1.0
      min_vel_theta: -1.0

      path_distance_bias: 0.61
      goal_distance_bias: 0.81
      occdist_scale: 0.011


    k_trans: 2.0
    k_rot: 1.0

    # within this distance to the goal, finally rotate to the goal heading (also, we've reached our goal only if we're within this dist)
    tolerance_trans: 0.25

    # we've reached our goal only if we're within this angular distance
    tolerance_rot: 0.3

    # we've reached our goal only if we're within range for this long and stopped
    tolerance_timeout: 0.5

    

    # number of samples (scaling factors of our current desired twist) to check the validity of 
    samples: 10

    # go no faster than this
    max_vel_lin: 0.3
    max_vel_th: 0.5

    # minimum velocities to keep from getting stuck
    min_vel_lin: 0.05
    min_vel_th: 0.1

    # if we're rotating in place, go at least this fast to avoid getting stuck
    min_in_place_vel_th: 0.1

    # when we're near the end and would be trying to go no faster than this translationally, just rotate in place instead
    in_place_trans_vel: 0.1

    # we're "stopped" if we're going slower than these velocities
    trans_stopped_velocity: 0.03
    rot_stopped_velocity: 0.1

    # if this is true, we don't care whether we go backwards or forwards
    allow_backwards: true

    # if this is true, turn in place to face the new goal instead of arcing toward it
    turn_in_place_first: true

    # if turn_in_place_first is true, turn in place if our heading is more than this far from facing the goal location
    max_heading_diff_before_moving: 0.4

# base_local_planner: base_local_planner/TrajectoryPlannerROS
TrajectoryPlannerROS:
  # Robot configuration
  acc_lim_x: 0.3
  acc_lim_y: 0
  acc_lim_theta: 0.5
  max_vel_x: 0.15
  min_vel_x: 0.05
  max_vel_theta: 0.6
  min_vel_theta: -0.6
  min_in_place_vel_theta: 0.2
  escape_vel: -0.1
  holonomic_robot: false

  # Visualize local planner costmap
  publish_cost_grid_pc: true

  # Goal tolerance
  yaw_goal_tolerance: 0.08
  xy_goal_tolerance: 0.1
  latch_xy_goal_tolerance: true

  # Forward simulaton parameters
  sim_time: 1.2
  sim_granularity: 0.025
  angular_sim_granularity: 0.04
  vx_samples: 15
  vtheta_samples: 20
  controller_frequency: 5

  # Trajectory scoring parameters
  meter_scoring: true
  pdist_scale: 2.2 #0.6
  gdist_scale: 0.8 #0.8
  occdist_scale: 0.1
  heading_lookahead: 0.325
  heading_scoring: true
  heading_scoring_timestep: 0.8
  dwa: true
  publish_cost_grid: false
  global_frame_id: map

  # Oscillation prevention parameter
  oscillation_reset_dist: 0.05

  # Global plan parameters
  prune_plan: true


# TrajectoryPlannerROS:
#   min_vel_x: 0.05
#   max_vel_x: 0.15
#   min_vel_theta: -0.6
#   max_vel_theta: 0.6
#   min_in_place_vel_theta: 0.3

#   acc_lim_theta: 0.3
#   acc_lim_x: 0.15
#   acc_lim_y: 0.0

#   # Diff drive
#   holonomic_robot: false
#   acc_lim_y: 0.0
#   min_vel_y: 0.0
#   max_vel_y: 0.0
#   vy_samples: 0

#   pdist_scale: 10


  # meter_scoring: true
  # xy_goal_tolerance: 0.1
  # sim_time: 10
  # pdist_scale: 1.2
  # gdist_scale: 0.4
  # occdist_scale: 0.01
  # dwa: false

  


  # occdist_scale: 1000.0
  # path_distance_bias: 

  # All parameters (possible bug?):
  # acc_lim_x: 0.1
  # acc_lim_y: 0.1
  # acc_lim_th: 0.3
  # max_vel_x: 0.3
  # min_vel_x: 0.1
  # max_vel_theta: 0.6
  # min_vel_theta: 0.05
  # min_in_place_vel_theta: 0.3
  # sim_time: 1.7
  # sim_granularity: 0.01
  # pdist_scale: 0.6
  # gdist_scale: 0.8
  # occdist_scale: 0.01
  # oscillation_reset_dist: 0.05
  # oscillation_timeout: 1
  # escape_reset_dist: 0.1
  # escape_reset_theta: 1.5708
  # vx_samples: 20
  # vtheta_samples: 20
  # heading_lookahead: 0.325
  # holonomic_robot: false
  # escape_vel: -0.1
  # dwa: false
  # heading_scoring: true
  # heading_scoring_timestep: 0.1
  # simple_attractor: true
  # angular_sim_granularity: 0.025